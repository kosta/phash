<!DOCTYPE html>
<!-- 
  Licensed under terms of the WTF?! License
  Programs licensed under the WTF?! License are so fscking simple
  that they don't even count as a "demo" or "example" program, but
  instead could be written by your grandma or a five-year old, respectively.
  Do whatever dirty deeds you want with programs licensed under the WTF?!
  license. Even something evil. I mean: WTF?!
-->
<html>
  <head>
    <meta name="viewport" content="user-scalable=no, width=device-width" />
    <title>phash - one password to hash them all</title>
    <style type="text/css">
      .phash { font-size: xx-large; font-weight: bold; font-size: x-large }
      a { text-decoration: none; }
      .header { color: #555; margin: 0; padding: 0; font-size: x-large }
      .result { font-weight: bold; border: 0px; font-family: monospace; text-color: blue; 
        text-align: center; width: 95%; max-width: 310px; background-color: #ddd; }
      span { color: red; font-weight: bold; }
      body { font-family: sans-serif; text-align: center; margin: 0; padding: 0; overflow: hidden }
      .info { font-size: small; }        
    </style>
  </head>
  <body>
      <div class=header>
        one password<br>
        to hash them all
      </div>
      <form>
        <div class=f>
          <p>
            master password:<br>
            <input type="password" size="16">
            <span id="pex"></span><br>
          </p>
          <p>
            website (or whatever):<br>
            <input type="text" size="16">
            <span id="tex"></span>
          </p>
        <a class="phash" href="#">phash...</a>
      </form>
      <p>
        <div>
          Your new password:<br>
          <input class="result" type="text" id="result"></input>
        </div>
      </p>      
      <div class="info">
        <a href="http://github.com/kosta/phash">more info</a>
      </div>
  </body>
  <script src="sha1.js"></script>
  <script src="jquery-1.4.2.min.js"></script>
  <script>
    function check() {
      var pass = $("form input:password")[0].value,
      site = $("form input:text")[0].value;
      //require at least some input
      $("#pex").text(("" === pass) ? "!" : "");
      $("#tex").text(("" === site) ? "!" : "");
      return [("" !== pass) && ("" !== site),
        pass, site];
    }
    function phash() {
      var a = check();
      if (a[0]) {
        //output hash
        $("#result").val(hex_sha1(a[1]+a[2]));
      } //both have values
      return false;
    } //function phash
    $(function() { 
      $(".phash").attr("href", "javascript:(function(){phash();return false;})()");
      $(".phash").text("phash!");
      $("form input:password").change(check);
      $("form input:input").change(check);
      $("form").submit(phash);
    }); //$(function)
  </script>
</html>